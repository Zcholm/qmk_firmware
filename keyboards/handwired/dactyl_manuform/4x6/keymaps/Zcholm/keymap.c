#include QMK_KEYBOARD_H


#define _BASE 0
#define _SWE 1
#define _RAISE 2
#define _LOWER 3

// Fillers to make layering more clear
#define ____ KC_TRNS

#define SFT_ESC  SFT_T(KC_ESC)
#define CTL_BSPC CTL_T(KC_BSPC)
#define ALT_SPC  ALT_T(KC_SPC)
#define SFT_ENT  SFT_T(KC_ENT)

#define KC_ML KC_MS_LEFT
#define KC_MR KC_MS_RIGHT
#define KC_MU KC_MS_UP
#define KC_MD KC_MS_DOWN
#define KC_MB1 KC_MS_BTN1
#define KC_MB2 KC_MS_BTN1

#define RAISE MO(_RAISE)
#define LOWER MO(_LOWER)

/* Swedish layer is toggled by tapping both layer buttons: */
#define SWE   TG(_SWE)

/* Home row mod-taps in base layer: */
#define MC_A     LCTL_T(KC_A)
#define MC_S     LALT_T(KC_S)
#define MC_D     LSFT_T(KC_D)
#define MC_F     LGUI_T(KC_F)
#define MC_J     RGUI_T(KC_J)
#define MC_K     RSFT_T(KC_K)
#define MC_L     RALT_T(KC_L)
#define MC_SCLN  RCTL_T(KC_SCLN)

/* Home row mod-taps in num layer: */
#define MC_1  LCTL_T(KC_1)
#define MC_2  LALT_T(KC_2)
#define MC_3  LSFT_T(KC_3)
#define MC_4  LGUI_T(KC_4)
#define MC_7  RGUI_T(KC_7)
#define MC_8  RSFT_T(KC_8)
#define MC_9  RALT_T(KC_9)
#define MC_0  RCTL_T(KC_0)

/* Swedish åäö: */
#define MC_AA  (RALT(KC_W))
#define MC_AE  (RALT(KC_Q))
#define MC_OE  (RALT(KC_P))

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

/* Base (qwerty)
 * +-----------------------------------------+                +-----------------------------------------+
 * | ESC  |   q  |   w  |   e  |   r  |   t  |                |   y  |   u  |   i  |   o  |   p  |   -  |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * | TAB  |   a  |   s  |   d  |   f  |   g  |                |   h  |   j  |   k  |   l  |   ;  |   '  |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * | SHFT |   z  |   x  |   c  |   v  |   b  |                |   n  |   m  |   ,  |   .  |   /  |   \  |
 * +------+------+------+------+-------------+                +-------------+------+------+------+------+
 * |      |      |      |      |                                            |      |      |      |      |
 * +------+------+-------------+-------------+                +-------------+-------------+------+------+
 *                             |      |      |                |      |      |
 *                             |RAISE | SPC  |                | ENT  | LOWER|
 *                             |      +------+                +------|      |
 *                             +------+                              +------+
 *                                    +-------------+  +-------------+
 *                                    |  TAB | BSP  |  |  DEL |  `   |
 *                                    |------+------|  |------+------|
 *                                    |      |      |  |      |      |
 *                                    +-------------+  +-------------+
 */
[_BASE] = LAYOUT( \
    KC_GESC, KC_Q,    KC_W,    KC_E,    KC_R,    KC_T,               KC_Y,    KC_U,    KC_I,    KC_O,    KC_P,    KC_MINS,   \
    KC_TAB,  MC_A,    MC_S,    MC_D,    MC_F,    KC_G,               KC_H,    MC_J,    MC_K,    MC_L,    MC_SCLN, KC_QUOT,   \
    KC_LSFT, KC_Z,    KC_X,    KC_C,    KC_V,    KC_B,               KC_N,    KC_M,    KC_COMM, KC_DOT,  KC_SLSH, KC_BSLASH, \
    _______, _______, _______, _______,                                                _______, _______,  _______, _______,  \
                                        RAISE,   KC_SPC,             KC_ENT,  LOWER,                                         \

                                        KC_TAB,  KC_BSPC,            KC_DEL,  KC_GRV,                                        \
                                        _______, _______,            _______, _______                                        \
),

/* Swedish (qwerty)
 * +-----------------------------------------+                +-----------------------------------------+
 * | ESC  |   q  |   w  |   e  |   r  |   t  |                |   y  |   u  |   i  |   o  |   p  |   å  |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * | TAB  |   a  |   s  |   d  |   f  |   g  |                |   h  |   j  |   k  |   l  |   ö  |   ä  |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * | SHFT |   z  |   x  |   c  |   v  |   b  |                |   n  |   m  |   ,  |   .  |   /  |   \  |
 * +------+------+------+------+-------------+                +-------------+------+------+------+------+
 * |      |      |      |      |                                            |      |      |      |      |
 * +------+------+-------------+-------------+                +-------------+-------------+------+------+
 *                             |      |      |                |      |      |
 *                             |RAISE | SPC  |                | ENT  | LOWER|
 *                             |      +------+                +------|      |
 *                             +------+                              +------+
 *                                    +-------------+  +-------------+
 *                                    |  TAB | BSP  |  |  DEL |  `   |
 *                                    |------+------|  |------+------|
 *                                    |      |      |  |      |      |
 *                                    +-------------+  +-------------+
 */
[_SWE] = LAYOUT(
    _______, _______, _______, _______, _______, _______,            _______, _______, _______, _______, _______, MC_AA,    \
    _______, _______, _______, _______, _______, _______,            _______, _______, _______, _______, MC_OE,   MC_AE,    \
    _______, _______, _______, _______, _______, _______,            _______, _______, _______, _______, _______, _______,  \
    _______, _______, _______, _______,                                                _______, _______, _______, _______,  \
                                        _______, _______,            _______, _______,                                      \
                                        _______, _______,            _______, _______,                                      \
                                        _______, _______,            _______, _______                                       \
),

/*
 * +-----------------------------------------+                +-----------------------------------------+
 * |      |      |      |      |      |      |                |      |      |      |      |      |      |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * |      |      |      |      |      |      |                |      |      |      |      |      |      |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * |      |      |      |      |      |      |                |      |      |      |      |      |      |
 * +------+------+------+------+-------------+                +-------------+------+------+------+------+
 * |      |      |      |      |                                            |      |      |      |      |
 * +------+------+-------------+-------------+                +-------------+-------------+------+------+
 *                             |      |      |                |      |      |
 *                             |      |      |                |      |      |
 *                             |      +------+                +------|      |
 *                             +------+                              +------+
 *                                    +-------------+  +-------------+
 *                                    |      |      |  |      |      |
 *                                    |------+------|  |------+------|
 *                                    |      |      |  |      |      |
 *                                    +-------------+  +-------------+
 *
 * [_NNN] = LAYOUT( \
 *     _______, _______, _______, _______, _______, _______,            _______, _______, _______, _______, _______, _______,  \
 *     _______, _______, _______, _______, _______, _______,            _______, _______, _______, _______, _______, _______,  \
 *     _______, _______, _______, _______, _______, _______,            _______, _______, _______, _______, _______, _______,  \
 *     _______, _______, _______, _______,                                                _______, _______, _______, _______,  \
 *                                         _______, _______,            _______, _______,                                      \
 *                                         _______, _______,            _______, _______,                                      \
 *                                         _______, _______,            _______, _______                                       \
 * ),
 */

/* LOWER:
 * +-----------------------------------------+                +-----------------------------------------+
 * |  `   |  !   |  @   |  #   |  $   |  %   |                |  ^   |  &   |  *   |  (   |  )   |  +   |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * |  ~   |  1   |  2   |  3   |  4   |  5   |                |  6   |  7   |  8   |  9   |  0   |  =   |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * |      |      |      |      |  {   |  [   |                |  ]   |  }   |      |      | INS  | RST  |
 * +------+------+------+------+-------------+                +-------------+------+------+------+------+
 * |      |      |      |      |                                            |      |      |      |      |
 * +------+------+-------------+-------------+                +-------------+-------------+------+------+
 *                             |      |      |                |      |      |
 *                             | SWE  |      |                |      |      |
 *                             |      +------+                +------|      |
 *                             +------+                              +------+
 *                                    +-------------+  +-------------+
 *                                    |      |      |  |      |      |
 *                                    |------+------|  |------+------|
 *                                    |      |      |  |      |      |
 *                                    +-------------+  +-------------+
 */
[_LOWER] = LAYOUT(
    KC_GRV,  KC_EXLM, KC_AT,   KC_HASH, KC_DLR,  KC_PERC,            KC_CIRC, KC_AMPR, KC_ASTR, KC_LPRN, KC_RPRN, KC_PLUS,  \
    KC_TILD, MC_1,    MC_2,    MC_3,    MC_4,    KC_5,               KC_6,    MC_7,    MC_8,    MC_9,    MC_0,    KC_EQL,   \
    _______, _______, _______, _______, KC_LCBR, KC_LBRC,            KC_RBRC, KC_RCBR, _______, _______, KC_INS,  RESET,    \
    _______, _______, _______, _______,                                                _______, _______, _______, _______,  \
                                        SWE,     _______,            _______, _______,                                      \
                                        _______, _______,            _______, _______,                                      \
                                        _______, _______,            _______, _______                                       \
),

/* RAISE:
 * +-----------------------------------------+                +-----------------------------------------+
 * |      |      |  F1  |  F2  |  F3  |  F4  |                | 🖱←  | 🖱↓  | 🖱↑  | 🖱→  | 🖱L  | 🖱R  |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * |      |      |  F5  |  F6  |  F7  |  F8  |                |  ←   |  ↓   |  ↑   |  →   | next | VolU |
 * |------+------+------+------+------+------|                |------+------+------+------+------+------|
 * | RST  |      |  F9  |  F10 |  F11 |  F12 |                | HOME | PGDN | PGUP | END  | prev | VolD |
 * +------+------+------+------+-------------+                +-------------+------+------+------+------+
 * |      |      |      |      |                                            |      |      |      |      |
 * +------+------+-------------+-------------+                +-------------+-------------+------+------+
 *                             |      |      |                |      |      |
 *                             |      |      |                |      | SWE  |
 *                             |      +------+                +------|      |
 *                             +------+                              +------+
 *                                    +-------------+  +-------------+
 *                                    |      |      |  |      |      |
 *                                    |------+------|  |------+------|
 *                                    |      |      |  |      |      |
 *                                    +-------------+  +-------------+
 */
[_RAISE] = LAYOUT(
    _______, _______, KC_F1,   KC_F2,   KC_F3,   KC_F4,              KC_MS_L, KC_MS_D, KC_MS_U, KC_MS_R, KC_BTN1, KC_BTN2,  \
    _______, _______, KC_F5,   KC_F6,   KC_F7,   KC_F8,              KC_LEFT, KC_DOWN, KC_UP,   KC_RGHT, KC_MNXT, KC_VOLU,  \
    RESET,   _______, KC_F9,   KC_F10,  KC_F11,  KC_F12,             KC_HOME, KC_PGDN, KC_PGUP, KC_END,  KC_MPRV, KC_VOLD,  \
    _______, _______, _______, _______,                                                _______, _______, _______, _______,  \
                                        _______, _______,            _______, SWE,                                          \
                                        _______, _______,            _______, _______,                                      \
                                        _______, _______,            _______, _______                                       \
)
};

void persistent_default_layer_set(uint16_t default_layer) {
  eeconfig_update_default_layer(default_layer);
  default_layer_set(default_layer);
}

void early_hardware_init_post(void) {
   setPinInputHigh(SPLIT_HAND_PIN);
   writePinLow(B0);
   writePinLow(D5);
}

